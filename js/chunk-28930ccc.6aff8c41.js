(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-28930ccc"],{"033b":function(t,e,i){"use strict";i("d79e")},1182:function(t,e,i){},"12d4":function(t){t.exports=JSON.parse('["蝶恋花","龙争虎斗","长安城","幽月轮","斗转星移","剑胆琴心","乾坤一掷","唯我独尊","梦江南","绝代天骄","天鹅坪","破阵子","飞龙在天","眉间雪","山海相逢","傲血戰意","山海相逢","眉间雪"]')},2412:function(t,e,i){"use strict";i("88c8")},"303a":function(t,e,i){"use strict";i("b071")},"47db":function(t,e,i){},"61eb":function(t,e,i){"use strict";i("7066")},7066:function(t,e,i){},"71f8":function(t,e,i){},"74ae":function(t,e,i){"use strict";i("d4a3")},"7b47":function(t,e,i){"use strict";i("1182")},"88c8":function(t,e,i){},"89ef":function(t,e,i){"use strict";i("c1d9")},af55:function(t,e,i){"use strict";i("71f8")},b071:function(t,e,i){},bbd9:function(t,e,i){"use strict";i("ee7c")},c1d9:function(t,e,i){},d4a3:function(t,e,i){},d695:function(t,e,i){"use strict";i("47db")},d79e:function(t,e,i){},dd55:function(t,e,i){"use strict";i("e00f")},e00f:function(t,e,i){},e777:function(t,e,i){"use strict";i.r(e);var a=function(){var t=this,e=t._self._c;return e("div",{staticClass:"p-price"},[e("PriceTabs",{attrs:{params:t.params},on:{changeTab:t.changeTab}}),""==t.params.currentTab?e("overview"):t._e(),"gold"==t.params.currentTab?e("gold"):t._e(),"goods"==t.params.currentTab?e("goods",{attrs:{keywords:t.params.keywords}}):t._e()],1)},s=[],o=(i("14d9"),function(){var t=this,e=t._self._c;return e("div",{staticClass:"m-price-tabs m-common-tabs"},[t._l(t.tabs,(function(i,a){return[e("div",{key:a,staticClass:"u-tab",class:{active:t.params.currentTab==i.value},on:{click:function(e){return t.changeTab(i)}}},[t._v(" "+t._s(i.label)+" ")])]})),e("div",{staticClass:"u-search"},["gold"!=t.params.currentTab?e("el-input",{staticClass:"u-search-input",attrs:{placeholder:"请输入","suffix-icon":"el-icon-search"},model:{value:t.params.keywords,callback:function(e){t.$set(t.params,"keywords",e)},expression:"params.keywords"}}):t._e()],1)],2)}),n=[],r={props:{params:{}},data:function(){return{tabs:[{label:"总览",value:""},{label:"金价",value:"gold"},{label:"物价",value:"goods"}]}},watch:{"params.keywords":{handler:function(t,e){""===this.params.currentTab&&(this.params.currentTab="goods")},deep:!0}},methods:{changeTab:function(t){this.params.currentTab=t.value,this.$emit("changeTab",t.value)}}},l=r,c=(i("303a"),i("2877")),d=Object(c["a"])(l,o,n,!1,null,null,null),u=d.exports,v=function(){var t=this,e=t._self._c;return e("div",{staticClass:"p-price-overview"},[e("div",{staticClass:"m-price-overview-header"},[e("div",{staticClass:"u-title"},[t._v("走势速览")]),e("div",{staticClass:"u-servers"},[e("el-select",{attrs:{placeholder:"请选择","default-first-option":!0},on:{change:t.serverChange},model:{value:t.server,callback:function(e){t.server=e},expression:"server"}},[e("div",{attrs:{slot:"prefix"},slot:"prefix"},[t._v("区服价格")]),t._l(t.serverList,(function(t){return e("el-option",{key:t,attrs:{label:t,value:t}})}))],2)],1)]),e("div",{staticClass:"m-price-overview-body"},[t.server?e("goldCharts",{attrs:{server:t.server}}):t._e(),t.isZl&&t.server?e("goods",{ref:"goods",attrs:{server:t.server}}):t._e()],1)])},f=[],m=i("60d7"),h=i("a59a"),p=i("7bdf"),g=function(){var t=this,e=t._self._c;return e("div",{staticClass:"p-price-goods overview"},[e("div",{staticClass:"m-price-goods-body"},[e("div",{staticClass:"m-my-follow-goods"},[e("div",{staticClass:"u-title"},[t._v(" 我的关注 "),t.myFollowData.length?e("i",{directives:[{name:"popover",rawName:"v-popover:myPlans",arg:"myPlans"}],staticClass:"u-btn el-icon-setting",attrs:{title:"设置清单"},on:{click:t.openAddDialog}}):t._e()]),0==t.myFollowData.length?e("div",{staticClass:"m-empty-follow"},[e("div",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],staticClass:"m-empty-follow-title"},[t._v(" "+t._s(t.isLogin?"暂无关注":"暂未登录")+" "),t.isLogin?e("span",{staticClass:"m-empty-follow-add",on:{click:t.openAddDialog}},[t._v(" 去添加 ")]):e("span",{staticClass:"m-empty-follow-login",on:{click:t.openAddDialog}},[t._v(" 去登陆 ")])])]):e("myGoodList",{attrs:{data:t.myFollowPlan,priceMap:t.priceMap}})],1)]),t.showMyGoods?e("myGoodsDialog",{attrs:{myFollowData:t.myFollowData},on:{close:function(e){t.showMyGoods=!1},setMyFollowList:t.setMyFollowList}}):t._e()],1)},y=[],b=(i("4de4"),i("d81d"),i("e9f5"),i("910d"),i("7d54"),i("ab43"),i("d3b7"),i("820e"),i("3ca3"),i("159b"),i("ddb0"),i("12d4")),w=function(){var t=this,e=t._self._c;return e("div",{staticClass:"m-mygoods"},[t._l(t.data,(function(i){var a;return e("div",{key:i.id,staticClass:"m-mygoods-plan"},[e("div",{staticClass:"m-mygoods-plan-label"},[t._v(" "+t._s(i.title)+" ")]),null!==(a=t.mergeData(i.relation))&&void 0!==a&&a.length?e("div",{staticClass:"m-mygoods-list"},t._l(t.mergeData(i.relation),(function(i){return e("div",{key:i.id,staticClass:"m-mygoods-list-item",on:{click:function(e){return t.goItemPage(i.id)}}},[e("img",{staticClass:"u-icon",attrs:{src:t.iconLink(i.IconID),alt:""}}),e("div",{staticClass:"m-mygoods-list-item-info"},[e("div",{staticClass:"m-mygoods-list-item-label"},[t._v(t._s(i.Name||""))]),e("div",{staticClass:"m-mygoods-list-item-money"},[t.priceMap[i.id]?e("GamePrice",{attrs:{price:t.priceMap[i.id]||0}}):e("div",{staticClass:"is-null"},[t._v("暂无价目")])],1)])])})),0):t._e()])})),e("el-backtop")],2)},_=[],C=(i("99af"),i("85e4")),x=i("1248"),D={props:{data:{},priceMap:{}},components:{GamePrice:x["a"]},methods:{iconLink:C["l"],filterSameItem:function(t){var e=[],i={};return t.forEach((function(t){i[t.id]||(e.push(t),i[t.id]=!0)})),e},mergeData:function(t){var e=[];return(null===t||void 0===t?void 0:t.length)&&t.forEach((function(t){t.data.forEach((function(t){e.push(t)}))})),e},goItemPage:function(t){var e=location.origin;window.open("".concat(e,"/item/view/").concat(t),"_blank"),sessionStorage.setItem("server_name",this.server)}}},k=D,L=(i("2412"),Object(c["a"])(k,w,_,!1,null,null,null)),F=L.exports,M=function(){var t=this,e=t._self._c;return e("el-dialog",{attrs:{title:"设置关注清单",visible:t.dialogVisible,width:"50%"},on:{"update:visible":function(e){t.dialogVisible=e},close:function(e){return t.$emit("close")}}},[e("div",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],staticClass:"m-price-goods-mygoods"},[t.myPlanList.length?t._l(t.myPlanList,(function(i){return e("div",{key:i.id,staticClass:"m-price-goods-mygoods-group",on:{click:function(e){return t.choiceGroup(i)}}},[t._v(" "+t._s(i.title)+" "),e("el-checkbox",{attrs:{readonly:""},model:{value:i.checked,callback:function(e){t.$set(i,"checked",e)},expression:"group.checked"}})],1)})):e("div",[e("div",{staticClass:"m-price-goods-empty",on:{click:t.goItem}},[t._v("还没有清单，"),e("span",{staticClass:"strong"},[t._v("去创建")])])])],2),e("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[e("el-button",{on:{click:function(e){return t.$emit("close")}}},[t._v("取 消")]),e("el-button",{attrs:{type:"primary"},on:{click:t.setMyFollowList}},[t._v("确 定")])],1)])},P=[],G=(i("caad"),i("a15b"),i("a434"),i("e9c4"),i("b64b"),i("2532"),i("41cb"));function O(){return Object(G["a"])().get("/api/cms/app/item-plan/mine",{params:{no_page:1,_no_cache:1}}).then((function(t){return t.data.data}))}var S,j=i("c9d2"),A={props:{myFollowData:{}},data:function(){return{myPlanList:[],dialogVisible:!0,loading:!1}},methods:{handleClose:function(){this.dialogVisible=!1},getPlanList:function(){var t=this;this.loading=!0,O({no_page:1}).then((function(e){t.loading=!1,t.myPlanList=e.reverse()||[],t.myPlanList.forEach((function(e){t.$set(e,"checked",t.followIdList.includes(e.id))}))}))},choiceGroup:function(t){if(t.checked=!t.checked,t.checked)this.followIdList.push(t.id);else{var e=this.followIdList.indexOf(t.id);e>-1&&this.followIdList.splice(this.followIdList.indexOf(t.id),1)}},setMyFollowList:function(){var t=this.myPlanList.map((function(t){return t.id})),e=this.followIdList.filter((function(e){return t.includes(e)})).join(",");this.$emit("setMyFollowList",e)},goItem:function(){var t=location.origin;window.open("".concat(t,"/pvg/manufacture"))}},mounted:function(){this.followIdList=JSON.parse(JSON.stringify(this.myFollowData)),j["a"].isLogin()&&this.getPlanList()}},E=A,$=(i("7b47"),Object(c["a"])(E,M,P,!1,null,null,null)),T=$.exports,I=(i("cc9a"),{props:{server:{}},components:{myGoodsDialog:T,myGoodList:F},data:function(){return{server_std:b,systemGoodsData:[],priceMap:{},myFollowData:[],myFollowPlan:[],showMyGoods:!1,loading:!1,isLogin:j["a"].isLogin()}},computed:{client:function(){return this.$store.state.client}},methods:{getSystemGoodsData:function(){var t=this;Object(p["e"])({client:this.client}).then((function(e){t.systemGoodsData=e.data.data,t.getServerPriceData()}))},getServerPriceData:function(){var t=this,e=[];this.systemGoodsData.forEach((function(t){t.items.forEach((function(t){e.push(t.item_id)}))})),Object(p["d"])({item_ids:e,server:this.server,aggregate_type:"hourly"}).then((function(e){var i=e.data;t.priceMap={},i.forEach((function(e){t.priceMap[e.item_id]=e.price}))}))},getMyFollowList:function(){var t=this;this.loading=!0,Object(p["b"])().then((function(e){e.data.data?t.myFollowData=e.data.data.split(",").map((function(t){return+t})).filter((function(t){return!!t})):t.myFollowData=[];var i=[];t.myFollowData.forEach((function(e){var a=t.getPlan(e);i.push(a)})),Promise.allSettled(i).then((function(e){t.loading=!1,t.myFollowPlan=(e||[]).filter((function(t){return"fulfilled"===t.status})).map((function(t){return t.value})),t.getMyFollowGoodsPrice()}))}))},getPlan:function(t){return new Promise((function(e,i){Object(p["c"])(t).then((function(t){e(t.data.data)})).catch((function(t){i(t)}))}))},getMyFollowGoodsPrice:function(){var t,e=this,i=[],a={};(null===(t=this.myFollowPlan)||void 0===t?void 0:t.length)&&this.myFollowPlan.forEach((function(t){null===t||void 0===t||t.relation.forEach((function(t){null===t||void 0===t||t.data.forEach((function(t){var s=t.id;void 0==e.priceMap[s]&&void 0==a[s]&&(i.push(s),a[s]=!0)}))}))}))},openAddDialog:function(){this.isLogin?this.showMyGoods=!0:j["a"].toLogin()},setMyFollowList:function(t){var e=this;Object(p["g"])({val:t}).then((function(t){e.showMyGoods=!1,e.$message.success("设置成功"),e.getMyFollowList()}))},updatePrice:function(){this.priceMap={},this.getServerPriceData(),this.getMyFollowGoodsPrice()}},mounted:function(){j["a"].isLogin()?(this.getSystemGoodsData(),this.getMyFollowList()):this.getSystemGoodsData()}}),z=I,N=(i("74ae"),Object(c["a"])(z,g,y,!1,null,null,null)),B=N.exports,J=function(){var t=this,e=t._self._c;return e("div",{staticClass:"m-price-overview-gold-charts"},[t.currentDataList.length?e("list-cross",{attrs:{list:t.currentDataList,radius:0},scopedSlots:t._u([{key:"default",fn:function(t){return[e("dataPlane",{attrs:{item:t.item}})]}}],null,!1,1888571659)}):t._e()],1)},V=[],Y=(i("13d5"),i("4e82"),i("9485"),i("b680"),i("b0c0"),function(){var t=this,e=t._self._c;return e("div",{staticClass:"u-data-plane",class:{noData:!t.item.key},style:{background:t.colorMap[t.item.key]}},[e("div",{staticClass:"plane-header"},[e("div",{staticClass:"plane-data"},[e("div",{staticClass:"data-value"},[t._v(t._s(t.item.recommend||0))]),e("div",{staticClass:"data-label"},[t._v("建议价格")])]),e("div",{staticClass:"plane-channel"},[t._v(t._s(t.item.name))])]),e("div",{ref:"chart",staticClass:"plane-chart"}),e("div",{staticClass:"plane-xAxis"},[e("div",{staticClass:"xAxis-item"},[e("div",{staticClass:"xAxis-value"},[t._v(t._s(t.item.beforeYesterday||0))]),e("div",{staticClass:"xAxis-label"},[t._v("前日")])]),e("div",{staticClass:"xAxis-item"},[e("div",{staticClass:"xAxis-value"},[t._v(t._s(t.item.yesterday||0))]),e("div",{staticClass:"xAxis-label"},[t._v("昨日")])]),e("div",{staticClass:"xAxis-item"},[e("div",{staticClass:"xAxis-value"},[t._v(t._s(t.item.lastDay||0))]),e("div",{staticClass:"xAxis-label"},[t._v("今日")])])])])}),R=[],U=i("313e"),W={name:"GoodsPrice",props:["item"],components:{},data:function(){return{myChart:null,colorMap:{WBL:"#F8B238",UU898:"#AA66FF",5173:"#5DA0ED",DD373:"#30C7C7",7881:"#FF768B"}}},watch:{item:{handler:function(t){var e=this;t.key&&this.$nextTick((function(){e.setOption()}))},deep:!0,immediate:!0}},methods:{initChart:function(){var t=this;this.myChart=U["a"](this.$refs.chart);var e=function(){t.myChart.resize()};window.addEventListener("resize",e),this.$once("hook:beforeDestroy",(function(){window.removeEventListener("resize",e),t.myChart.dispose()}))},setOption:function(){if(this.myChart&&this.item.data.length){var t=this.item,e=t.beforeYesterday,i=t.yesterday,a=t.lastDay,s=[e,i,a],o=Math.min.apply(Math,s),n=Math.max.apply(Math,s);this.myChart.setOption({xAxis:{show:!1,type:"category",data:["前日","昨日","今日"],boundaryGap:!1},grid:{left:5,right:5,bottom:5,top:5},yAxis:{show:!1,type:"value",min:o,max:n},series:[{clip:!1,smooth:!0,data:s,type:"line",symbol:"none",lineStyle:{color:"#fff",width:5,cap:"round"},silent:!0}]})}}},created:function(){},mounted:function(){this.initChart()}},q=W,Z=(i("d695"),Object(c["a"])(q,Y,R,!1,null,"ede3c180",null)),H=Z.exports,K=i("015b"),Q={props:{server:{}},components:{ListCross:K["a"],dataPlane:H},data:function(){return{goldPriceData:{},loading:!1}},computed:{currentDataList:function(){var t=this.server,e=this.goldPriceData[t],i=[];for(var a in e){var s=e[a],o=s[s.length-1].average.toFixed(2),n=s[s.length-2].average.toFixed(2),r=s[s.length-3].average.toFixed(2),l=s.reduce((function(t,e){return t+e.average}),0),c=void 0;c="DD373"===a?((+o+ +n+ +r)/.9405/3).toFixed(2):((+o+ +n+ +r)/3).toFixed(2);var d={name:"WBL"===a?"万宝楼":a,key:a,recommend:c,sum:l,lastDay:o,yesterday:n,beforeYesterday:r,data:s};i.push(d)}return i=i.sort((function(t,e){return e.sum-t.sum})),i}},methods:{getData:function(){var t=this;this.loading=!0,Object(p["a"])().then((function(e){t.goldPriceData=e.data})).finally((function(){t.loading=!1}))}},mounted:function(){this.getData()}},X=Q,tt=Object(c["a"])(X,J,V,!1,null,null,null),et=tt.exports,it={components:{goods:B,goldCharts:et},data:function(){return{server:""}},computed:{client:function(){return this.$store.state.client},serverList:function(){return"std"==this.client?m:h},isZl:function(){var t;return!(null!==(t=this.$route.query)&&void 0!==t&&t.tab)}},methods:{serverChange:function(){var t=this;this.$nextTick((function(){t.$refs.goods.updatePrice()}))}},created:function(){var t=this;j["a"].isLogin()&&"std"==this.client?Object(p["f"])().then((function(e){var i,a;t.server=(null===(i=e.data)||void 0===i||null===(a=i.data)||void 0===a?void 0:a.jx3_server)||"梦江南"})):this.server="std"==this.client?"梦江南":"缘起稻香"}},at=it,st=(i("89ef"),Object(c["a"])(at,v,f,!1,null,null,null)),ot=st.exports,nt=function(){var t=this,e=t._self._c;return e("div",{staticClass:"p-price-gold"},[e("div",{staticClass:"m-price-gold-header"},[e("div",{staticClass:"u-title"},[t._v("金价走势")]),e("div",{staticClass:"u-servers"},[e("el-select",{attrs:{placeholder:"请选择","default-first-option":!0},on:{change:t.serverChange},model:{value:t.server,callback:function(e){t.server=e},expression:"server"}},[e("div",{attrs:{slot:"prefix"},slot:"prefix"},[t._v("区服价格")]),t._l(t.serverList,(function(t){return e("el-option",{key:t,attrs:{label:t,value:t}})}))],2)],1)]),e("div",{staticClass:"m-price-gold-body"},[t.server?e("goldChart",{ref:"chart",attrs:{server:t.server}}):t._e()],1)])},rt=[],lt=function(){var t=this,e=t._self._c;return e("div",{ref:"chartBox",staticClass:"m-price-chart-box"},[e("div",{staticClass:"legends"},t._l(t.currentDataList,(function(i,a){return e("div",{key:a,staticClass:"legends-item",class:{loading:t.loading},style:{background:t.colorMap[i.key]},on:{mouseover:function(e){return t.heightLight(a)},mouseout:function(e){return t.blur(a)}}},[e("div",{staticClass:"item-title"},[t._v(t._s(i.name))]),e("div",{staticClass:"item-data"},[e("div",[e("div",{staticClass:"data-value"},[t._v(t._s(i.beforeYesterday))]),e("div",{staticClass:"data-label"},[t._v("前日")])]),e("div",[e("div",{staticClass:"data-value"},[t._v(t._s(i.yesterday))]),e("div",{staticClass:"data-label"},[t._v("昨日")])]),e("div",[e("div",{staticClass:"data-value"},[t._v(t._s(i.lastDay))]),e("div",{staticClass:"data-label"},[t._v("今日")])])])])})),0),e("div",{ref:"chart",staticClass:"myChart"})])},ct=[],dt=(i("a630"),i("6062"),i("1e70"),i("79a4"),i("c1a1"),i("8b00"),i("a4e7"),i("1e5a"),i("72c3"),{props:{server:{}},data:function(){return{goldPriceData:{},colorMap:{WBL:"#F8B238",UU898:"#AA66FF",5173:"#5DA0ED",DD373:"#30C7C7",7881:"#FF768B"},myChart:null}},computed:{currentDataList:function(){var t=this.server,e=this.goldPriceData[t],i=[];for(var a in e){var s=e[a],o=s[s.length-1].average.toFixed(2),n=s[s.length-2].average.toFixed(2),r=s[s.length-3].average.toFixed(2),l=s.reduce((function(t,e){return t+e.average}),0),c={name:"WBL"===a?"万宝楼":a,key:a,sum:l,lastDay:o,yesterday:n,beforeYesterday:r,data:s};i.push(c)}return i=i.sort((function(t,e){return e.sum-t.sum})),i}},methods:{getData:function(){var t=this;this.loading=!0,Object(p["a"])().then((function(e){t.goldPriceData=e.data})).finally((function(){t.loading=!1,t.initChart(),t.setOption()}))},initChart:function(){var t=this;this.myChart=U["a"](this.$refs.chart);var e=this.$refs.chartBox,i=new ResizeObserver((function(e){t.chartResize()}));i.observe(e);var a=function(){t.chartResize()};window.addEventListener("resize",a),this.$once("hook:beforeDestroy",(function(){window.removeEventListener("resize",a),i.disconnect(),t.myChart.dispose()}))},chartResize:function(){var t=this;clearTimeout(S),S=setTimeout((function(){t.myChart.resize()}),100)},heightLight:function(t){clearTimeout(S),this.myChart.dispatchAction({type:"highlight",seriesIndex:t})},blur:function(t){var e=this;S=setTimeout((function(){e.myChart.dispatchAction({type:"downplay",seriesIndex:t})}),100)},setOption:function(){var t=this,e=[],i=this.currentDataList,a=[],s=1/0,o=-1/0,n=function(){var n=i[r].data||[],l=i[r].key,c=n.map((function(e){var i=e.average.toFixed(2);i>=o&&(o=i),i<=s&&(s=i);var n=e.date.substring(5);return a.push(n),{value:i,name:n,color:t.colorMap[l]}}));e.push({name:l,data:c,type:"line",smooth:!0,symbol:"circle",symbolSize:10,emphasis:{},lineStyle:{color:t.colorMap[l],width:3},itemStyle:{color:t.colorMap[l]},markPoint:{symbolSize:60,data:[{type:"max",name:"最高价",label:{formatter:"{c}",fontSize:10,color:"#fff"}},{type:"min",name:"最低价",label:{formatter:"{c}",fontSize:10,color:"#fff"}}]},markLine:{symbol:"none",data:[{type:"average",name:"平均价",label:{formatter:"均价 {c}",color:t.colorMap[l]}}]}})};for(var r in i)n();s=10*~~(s/10),o=10*(1+~~(o/10));var l=Array.from(new Set(a)).sort(),c={xAxis:{type:"category",data:l,boundaryGap:!1},yAxis:{type:"value",max:o,min:s,interval:(o-s)/5},grid:{left:20,right:90,containLabel:!0},dataZoom:[{type:"slider",show:!0,xAxisIndex:[0],start:0,end:100}],emphasis:{focus:"series"},tooltip:{trigger:"axis",axisPointer:{type:"cross",label:{backgroundColor:"#6a7985"}},formatter:function(e){var i="<span>".concat(e[0].axisValue,"</span><br/>");return i+="<span>服务器: ".concat(t.server,"</span><br/>"),e.forEach((function(e){var a=t.getMarker(e.data.color);i+="".concat(a,' <span style="display:inline-block;width:50px">').concat(e.seriesName,"</span>: ").concat(e.value,"<br/>")})),i}},series:e};this.myChart.resize(),this.myChart.setOption(c,!0)},getMarker:function(t){return'<span style="display:inline-block;margin-right:4px;border-radius:10px;width:10px;height:10px;background-color:'.concat(t,';"></span>')}},mounted:function(){this.getData()}}),ut=dt,vt=(i("af55"),Object(c["a"])(ut,lt,ct,!1,null,null,null)),ft=vt.exports,mt={components:{goldChart:ft},data:function(){return{server:""}},computed:{client:function(){return this.$store.state.client},serverList:function(){return"std"==this.client?m:h}},methods:{serverChange:function(){this.$refs.chart.setOption()}},created:function(){var t=this;j["a"].isLogin()&&"std"==this.client?Object(p["f"])().then((function(e){var i,a;t.server=(null===(i=e.data)||void 0===i||null===(a=i.data)||void 0===a?void 0:a.jx3_server)||"梦江南"})):this.server="std"==this.client?"梦江南":"缘起稻香"}},ht=mt,pt=(i("dd55"),Object(c["a"])(ht,nt,rt,!1,null,null,null)),gt=pt.exports,yt=function(){var t=this,e=t._self._c;return e("div",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],staticClass:"p-price-goods"},[e("div",{staticClass:"m-price-goods-header"},[e("div",{staticClass:"u-title"},[t._v("物价总览")]),e("div",{staticClass:"u-servers"},[e("el-select",{attrs:{placeholder:"请选择","default-first-option":!0},on:{change:t.updatePrice},model:{value:t.server,callback:function(e){t.server=e},expression:"server"}},[e("div",{attrs:{slot:"prefix"},slot:"prefix"},[t._v("区服价格")]),t._l(t.serverList,(function(t){return e("el-option",{key:t,attrs:{label:t,value:t}})}))],2)],1)]),e("div",{staticClass:"m-price-goods-body"},[e("div",{staticClass:"m-system-goods"},[e("systemGoodList",{attrs:{data:t.systemGoodsDataFilter,priceMap:t.priceMap}})],1)]),t.showMyGoods?e("myGoodsDialog",{attrs:{myFollowData:t.myFollowData},on:{close:function(e){t.showMyGoods=!1},setMyFollowList:t.setMyFollowList}}):t._e()],1)},bt=[],wt=(i("a732"),function(){var t=this,e=t._self._c;return e("div",{staticClass:"m-systemgoods"},[t._l(t.data,(function(i){return e("div",{key:i.id,staticClass:"m-systemgoods-group"},[e("div",{staticClass:"m-systemgoods-group-label"},[t._v(" "+t._s(i.label)+" ")]),e("div",{staticClass:"m-systemgoods-list"},t._l(t.filterSameItem(i.items),(function(i){return e("div",{key:i.item_id,staticClass:"m-systemgoods-list-item",on:{click:function(e){return t.goItemPage(i.item_id)}}},[e("img",{staticClass:"u-icon",attrs:{src:t.iconLink(i.icon),alt:""}}),e("div",{staticClass:"m-systemgoods-list-item-info"},[e("div",{staticClass:"m-systemgoods-list-item-label"},[t._v(t._s(i.label||""))]),e("div",{staticClass:"m-systemgoods-list-item-money"},[t.priceMap[i.item_id]?e("GamePrice",{attrs:{price:t.priceMap[i.item_id]}}):e("div",{staticClass:"is-null"},[t._v("暂无价目")])],1)])])})),0)])})),e("el-backtop")],2)}),_t=[],Ct={props:{data:{},priceMap:{}},components:{GamePrice:x["a"]},methods:{iconLink:C["l"],filterSameItem:function(t){var e=[],i={};return t.forEach((function(t){i[t.item_id]||(e.push(t),i[t.item_id]=!0)})),e},goItemPage:function(t){var e=location.origin;window.open("".concat(e,"/item/view/").concat(t),"_blank"),sessionStorage.setItem("server_name",this.server)}}},xt=Ct,Dt=(i("033b"),Object(c["a"])(xt,wt,_t,!1,null,null,null)),kt=Dt.exports,Lt={props:{keywords:{}},components:{systemGoodList:kt,myGoodsDialog:T},data:function(){return{server:"",systemGoodsData:[],priceMap:{},myFollowData:[],myFollowPlan:[],showMyGoods:!1,loading:!1}},computed:{client:function(){return this.$store.state.client},serverList:function(){return"std"==this.client?m:h},myFollowPlanFilter:function(){var t=this,e=JSON.parse(JSON.stringify(this.myFollowPlan));return this.keywords&&e.forEach((function(e){e.relation.forEach((function(e){e.data=e.data.filter((function(e){return e.Name&&e.Name.indexOf(t.keywords)>-1}))}))})),e=e.filter((function(t){return t.relation.some((function(t){return t.data.length>0}))})),e},systemGoodsDataFilter:function(){var t=this,e=JSON.parse(JSON.stringify(this.systemGoodsData));return this.keywords&&e.forEach((function(e){e.items=e.items.filter((function(e){return e.label&&e.label.indexOf(t.keywords)>-1}))})),e=e.filter((function(t){return t.items.length>0})),e}},methods:{getSystemGoodsData:function(){var t=this;Object(p["e"])({client:this.client}).then((function(e){t.systemGoodsData=e.data.data,t.getServerPriceData()}))},getServerPriceData:function(){var t=this,e=[];this.systemGoodsData.forEach((function(t){t.items.forEach((function(t){e.push(t.item_id)}))})),this.loading=!0,Object(p["d"])({item_ids:e,server:this.server,aggregate_type:"hourly"}).then((function(e){var i=e.data;t.priceMap={},i.forEach((function(e){t.priceMap[e.item_id]=e.price}))})).finally((function(){t.loading=!1}))},getMyFollowList:function(){var t=this;this.loading=!0,Object(p["b"])().then((function(e){e.data.data?t.myFollowData=e.data.data.split(",").map((function(t){return+t})).filter((function(t){return!!t})):t.myFollowData=[];var i=[];t.myFollowData.forEach((function(e){var a=t.getPlan(e);i.push(a)})),Promise.allSettled(i).then((function(e){t.loading=!1,t.myFollowPlan=(e||[]).filter((function(t){return"fulfilled"===t.status})).map((function(t){return t.value})),t.getMyFollowGoodsPrice()}))}))},getPlan:function(t){return new Promise((function(e,i){Object(p["c"])(t).then((function(t){e(t.data.data)})).catch((function(t){i(t)}))}))},getMyFollowGoodsPrice:function(){var t=this,e=[],i={};this.myFollowPlan.forEach((function(a){a.relation.forEach((function(a){a.data.forEach((function(a){var s=a.id;void 0==t.priceMap[s]&&void 0==i[s]&&(e.push(s),i[s]=!0)}))}))}))},openAddDialog:function(){this.showMyGoods=!0},setMyFollowList:function(t){var e=this;Object(p["g"])({val:t}).then((function(t){e.showMyGoods=!1,e.$message.success("设置成功"),e.getMyFollowList()}))},updatePrice:function(){this.getServerPriceData(),this.getMyFollowGoodsPrice()}},mounted:function(){var t=this;j["a"].isLogin()&&"std"===this.client?Object(p["f"])().then((function(e){var i,a;t.server=(null===(i=e.data)||void 0===i||null===(a=i.data)||void 0===a?void 0:a.jx3_server)||"梦江南",t.getSystemGoodsData(),t.getMyFollowList()})):(this.server="std"==this.client?"梦江南":"缘起稻香",this.getSystemGoodsData(),j["a"].isLogin()&&this.getMyFollowList())}},Ft=Lt,Mt=(i("bbd9"),Object(c["a"])(Ft,yt,bt,!1,null,null,null)),Pt=Mt.exports,Gt={components:{PriceTabs:u,overview:ot,gold:gt,goods:Pt},data:function(){return{params:{currentTab:"",keywords:""}}},methods:{changeTab:function(t){var e={};t&&(e.tab=t),this.$router.push({query:e})}},mounted:function(){this.params.currentTab=this.$route.query.tab||""}},Ot=Gt,St=(i("61eb"),Object(c["a"])(Ot,a,s,!1,null,null,null));e["default"]=St.exports},ee7c:function(t,e,i){}}]);