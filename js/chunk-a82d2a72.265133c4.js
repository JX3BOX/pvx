(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-a82d2a72"],{"018f":function(t,e,s){},e094:function(t,e,s){"use strict";s("018f")},fe9e:function(t,e,s){"use strict";s.r(e);s("99af"),s("b0c0");var a=function(){var t=this,e=t._self._c;return e("div",{staticClass:"m-body"},[t.isLogin?t.noRole?[e("div",{staticClass:"u-bind_role"},[e("el-empty",{attrs:{description:"当前暂未绑定角色",image:t.__imgPath+"/img/common/empty.png","image-size":200}},[e("a",{staticClass:"u-btn el-button el-button--primary",attrs:{href:"/team/role/bind"}},[t._v("前往绑定 "),e("i",{staticClass:"el-icon-arrow-right"})])])],1)]:[e("div",{staticClass:"m-related-roles"},[e("el-select",{attrs:{"value-key":"ID",placeholder:"请选择当前角色",disabled:!t.isLogin,"popper-class":"m-related-roles-options",size:"small"},model:{value:t.currentRole,callback:function(e){t.currentRole=e},expression:"currentRole"}},[e("span",{staticClass:"u-prefix",attrs:{slot:"prefix"},slot:"prefix"},[t._v(" 角色名称 "),t.isVirtual||t.isSync?t._e():e("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:"请先在游戏中同步成就",placement:"top"}},[e("a",{attrs:{href:"/tool/74559",target:"_blank"}},[e("i",{staticClass:"el-icon-warning-outline"})])])],1),t._l(t.roleList,(function(s){return e("el-option",{key:s.ID,attrs:{value:s,label:s.name}},[e("span",{staticClass:"u-role"},[e("span",{staticClass:"u-role-name"},[e("img",{staticClass:"u-role-icon",attrs:{src:t.showSchoolIcon(s.mount)}}),t._v(t._s(s.name))]),e("span",{staticClass:"u-role-server"},[t._v(t._s(s.server))])])])}))],2),e("el-select",{attrs:{placeholder:"请选择阵营","popper-class":"m-related-roles-options",size:"small"},model:{value:t.currentCamp,callback:function(e){t.currentCamp=e},expression:"currentCamp"}},[e("span",{staticClass:"u-prefix",attrs:{slot:"prefix"},slot:"prefix"},[t._v("所在阵营")]),e("el-option",{attrs:{value:"hq",label:"浩气盟阵营"}}),e("el-option",{attrs:{value:"er",label:"恶人谷阵营"}})],1)],1),t.noRole?t._e():e("div",{ref:"capture",attrs:{id:"capture"}},[e("div",{staticClass:"m-content",style:{zoom:t.contentZoom}},[e("div",{staticClass:"m-top"},[e("img",{staticClass:"u-top__img",attrs:{src:t.getCdnImgUrl("portrait/top.png")}})]),e("div",{staticClass:"m-introduce"},[e("div",{staticClass:"m-producer"},[e("img",{staticClass:"u-producer",attrs:{src:t.getCdnImgUrl("producer.png")}}),e("img",{staticClass:"u-title__icon",attrs:{src:t.getCdnImgUrl("portrait/title_icon.png")}})]),e("div",{staticClass:"m-info"},[e("div",{staticClass:"u-producer__text"},[t._v("*剑网3魔盒提供技术支持，茗伊插件提供数据支持。")]),e("div",{staticClass:"m-user"},[e("span",{staticClass:"u-name"},[t._v(t._s(t.roleInfo.name))]),e("img",{staticClass:"u-icon",attrs:{src:t.showSchoolIcon(t.roleInfo.mount)}})]),e("div",{staticClass:"u-progress"},[t._v("奇遇进度："+t._s(t.userAchievement.progress)+"%")]),e("div",{staticClass:"u-time"},[t._v("记录时间："+t._s(t.userAchievement.updated_at))]),e("img",{staticClass:"m-tip",attrs:{src:t.getCdnImgUrl("poetry_por.png")}})]),e("img",{staticClass:"u-introduce__bg",attrs:{src:t.getCdnImgUrl("content_bg.png")}})]),t.userAchievement?[e("div",{staticClass:"m-world"},[e("img",{staticClass:"u-world__bg",attrs:{src:t.getCdnImgUrl("world/world_bg.svg")}}),e("div",{staticClass:"m-world-count"},[e("img",{staticClass:"u-count__img",attrs:{src:t.getCdnImgUrl("portrait/world_qy_bg.png")}}),e("div",{staticClass:"m-count-info"},[t._v(" "+t._s(t.userAchievement.perfectNowNum+"/"+t.userAchievement.perfectAllNum)+" ")])]),t._l(t.userAchievement.perfect,(function(s,a){return e("div",{key:a,staticClass:"m-world-item",class:s.hasClass,style:{zIndex:s.zIndex}},[e("img",{staticClass:"u-item__img",attrs:{src:t.getCdnImgUrl("world/".concat(s.dwID).concat(s.isAct?"_act":"",".png"))}}),e("div",{staticClass:"m-item__text"},[e("img",{staticClass:"u-item__bg",attrs:{src:t.getCdnImgUrl("world/text_bg".concat(s.isAct?"_act":"",".png"))}}),e("span",{staticClass:"u-item__text"},[t._v(t._s(s.szName))])])])}))],2),e("div",{staticClass:"m-qy-box"},[e("div",{staticClass:"m-qy m-ordinary"},[e("div",{staticClass:"m-qy-count"},[e("img",{staticClass:"u-count__img",attrs:{src:t.getCdnImgUrl("portrait/pt_qy_bg.png")}}),e("div",{staticClass:"m-count-info"},[t._v(" "+t._s(t.userAchievement.normalNowNum+"/"+t.userAchievement.normalAllNum)+" ")])]),t.userAchievement.normal.length?e("div",{staticClass:"m-qy-list"},t._l(t.userAchievement.normal,(function(s,a){return e("div",{key:a,staticClass:"m-qy__item"},[[4,118].indexOf(s.dwID)>-1?[e("img",{directives:[{name:"show",rawName:"v-show",value:"hq"==t.currentCamp,expression:"currentCamp == 'hq'"}],staticClass:"u-qy__img",attrs:{src:t.getCdnImgUrl("pt/".concat(s.dwID,"_hq.png"))}}),e("img",{directives:[{name:"show",rawName:"v-show",value:"er"==t.currentCamp,expression:"currentCamp == 'er'"}],staticClass:"u-qy__img",attrs:{src:t.getCdnImgUrl("pt/".concat(s.dwID,"_er.png"))}})]:e("el-image",{staticClass:"u-qy__img",attrs:{src:t.getCdnImgUrl("pt/".concat(s.dwID,".png"))}},[e("el-image",{staticClass:"u-qy__img",attrs:{slot:"error",src:t.getCdnImgUrl("pt/default.png")},slot:"error"})],1),e("div",{staticClass:"m-qy__text"},[e("img",{staticClass:"u-qy__bg",attrs:{src:t.getCdnImgUrl("pt/text_bg.png")}}),e("span",{staticClass:"u-qy__text"},[t._v(t._s(s.szName))])])],2)})),0):e("div",{staticClass:"u-no-qy"},[e("img",{attrs:{src:t.getCdnImgUrl("portrait/no_qy.png")}})])]),e("div",{staticClass:"m-qy m-pet"},[e("div",{staticClass:"m-qy-count"},[e("img",{staticClass:"u-count__img",attrs:{src:t.getCdnImgUrl("portrait/pet_qy_bg.png")}}),e("div",{staticClass:"m-count-info"},[t._v(" "+t._s(t.userAchievement.petNowNum+"/"+t.userAchievement.petAllNum)+" ")])]),t.userAchievement.pet.length?e("div",{staticClass:"m-qy-list"},t._l(t.userAchievement.pet,(function(s,a){return e("div",{key:a,staticClass:"m-qy__item"},[e("img",{staticClass:"u-qy__img",attrs:{src:t.getImgUrl(s)}}),e("img",{staticClass:"u-qy__border",attrs:{src:t.getCdnImgUrl("pet_img_border.png")}})])})),0):e("div",{staticClass:"u-no-qy"},[e("img",{attrs:{src:t.getCdnImgUrl("portrait/no_qy.png")}})])])])]:t._e(),e("div",{staticClass:"m-bottom",class:{start:t.addClass,over:t.isOver}},[e("img",{staticClass:"u-bottom__img",attrs:{src:t.getCdnImgUrl("portrait/bottom.png")}})])],2)])]:[e("div",{staticClass:"u-bind_role"},[e("el-empty",{attrs:{description:"您还没有登录",image:t.__imgPath+"/img/common/empty.png","image-size":200}},[e("a",{staticClass:"u-btn el-button el-button--primary",attrs:{href:t.login_url}},[t._v("前往登录 "),e("i",{staticClass:"el-icon-arrow-right"})])])],1)]],2)},i=[],r=s("c7eb"),n=s("1da1"),o=s("5530"),c=(s("4de4"),s("e9f5"),s("910d"),s("d3b7"),s("ac1f"),s("5319"),s("987d")),l=s("85e4"),m=s("42e9"),u=s("c9d2"),d=s("c0e9"),g=s.n(d),p=s("65c2"),_={name:"portrait",inject:["__imgRoot","__imgPath"],data:function(){return{addClass:!1,isOver:!1,contentZoom:"",userAchievement:!1,roleList:[],noRole:!1,currentRole:"",currentCamp:"hq",roleInfo:{},isLogin:u["a"].isLogin(),virtualRole:Object(o["a"])(Object(o["a"])({},u["a"].getInfo()),{},{jx3id:0,ID:~~u["a"].getInfo().uid}),isSync:!1,login_url:p["__Links"].account.login+"?redirect="+location.href}},computed:{client:function(){return this.$store.state.client}},watch:{currentRole:{deep:!0,handler:function(t){this.roleInfo=t,t.jx3id&&this.loadRole(t.jx3id)}},virtualRole:{immediate:!0,deep:!0,handler:function(t){this.currentRole=t}}},mounted:function(){var t=this;Object(c["d"])().then((function(e){var s,a;e.data.data.list.length?(t.noRole=!1,t.roleList=(null===(s=e.data)||void 0===s||null===(a=s.data)||void 0===a?void 0:a.list.filter((function(t){return!!t.player_id})))||[],t.roleList.length&&(t.currentRole=t.roleList[0])):(t.noRole=!0,t.$message.error("未获取到角色信息"))}))},methods:{saveAsImage:function(){var t=this;return Object(n["a"])(Object(r["a"])().mark((function e(){var s,a,i,n,o;return Object(r["a"])().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.prev=0,s=t.contentZoom,t.contentZoom=1,e.next=5,new Promise((function(e){t.$nextTick((function(){e()}))}));case 5:return a=t.$refs.capture,e.next=8,g()(a,{allowTaint:!0,useCORS:!0,width:a.offsetWidth,height:a.offsetHeight});case 8:i=e.sent,t.contentZoom=s,n=i.toDataURL("image/png"),o=document.createElement("a"),o.href=n,o.download="downloaded-image.png",o.click(),e.next=20;break;case 17:e.prev=17,e.t0=e["catch"](0),console.error("Error saving image:",e.t0);case 20:case"end":return e.stop()}}),e,null,[[0,17]])})))()},loadRole:function(t){var e=this;Object(m["a"])(t).then((function(s){e.isSync=!!t,e.userAchievement=s,e.addClass=!1,e.isOver=!1,e.$nextTick((function(t){e.start()}))}))},start:function(){var t=this;this.addClass=!0,setTimeout((function(){t.addClass=!1,t.isOver=!0}),2e3),window.addEventListener("resize",this.handleScreenWidthChange),window.addEventListener("load",this.handleScreenWidthChange),this.handleScreenWidthChange()},isVirtual:function(){var t;return!(null!==(t=this.currentRole)&&void 0!==t&&t.jx3id)},getImgUrl:function(t){var e,s="std",a=null===(e=t.szOpenRewardPath)||void 0===e?void 0:e.toLowerCase();if(!a)return"";if(a=a.replace(/\\/g,"/").replace("ui/image/adventure/",""),!t.szRewardType){var i=a.replace(/\.tga$/,".png");return"".concat(this.__imgRoot,"adventure/").concat(s,"/").concat(i)}return a=a.replace(/\/[^\/]+?\.tga$/,""),"camp"===t.szRewardType?"".concat(this.__imgRoot,"adventure/").concat(s,"/").concat(a,"/camp_").concat(this.camp,"_open.png"):"school"===t.szRewardType?"".concat(this.__imgRoot,"adventure/").concat(s,"/").concat(a,"/school_").concat(this.force,"_open.png"):defaultImg},handleScreenWidthChange:function(){var t=window.innerWidth-40,e=900,s=t/e,a=1;t<=e&&(a=s),this.contentZoom=a},showSchoolIcon:l["s"],getCdnImgUrl:function(t){return"".concat(p["__cdn"],"design/treasure/").concat(t)}}},v=_,C=(s("e094"),s("2877")),h=Object(C["a"])(v,a,i,!1,null,null,null);e["default"]=h.exports}}]);