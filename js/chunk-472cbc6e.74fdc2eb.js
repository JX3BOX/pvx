(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-472cbc6e"],{"1a39":function(t,e,a){"use strict";a("652d")},"57ac":function(t,e,a){},"652d":function(t,e,a){},"91f1":function(t,e,a){"use strict";a("57ac")},b85c:function(t,e,a){"use strict";a.d(e,"a",(function(){return n}));a("a4d3"),a("e01a"),a("d28b"),a("d9e2"),a("d3b7"),a("3ca3"),a("ddb0");var s=a("06c5");function n(t,e){var a="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!a){if(Array.isArray(t)||(a=Object(s["a"])(t))||e&&t&&"number"==typeof t.length){a&&(t=a);var n=0,r=function(){};return{s:r,n:function(){return n>=t.length?{done:!0}:{done:!1,value:t[n++]}},e:function(t){throw t},f:r}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,o=!0,c=!1;return{s:function(){a=a.call(t)},n:function(){var t=a.next();return o=t.done,t},e:function(t){c=!0,i=t},f:function(){try{o||null==a["return"]||a["return"]()}finally{if(c)throw i}}}}},e5d0:function(t,e,a){"use strict";a("99af"),a("b0c0");var s=function(){var t=this,e=t._self._c;return t.userAchievement?e("div",{staticClass:"m-portrait-content",style:{zoom:t.contentZoom}},[e("div",{staticClass:"m-top"},[e("img",{staticClass:"u-top__img",attrs:{src:t.getCdnImgUrl("portrait/top.png")}})]),e("div",{staticClass:"m-introduce"},[e("div",{staticClass:"m-producer"},[e("img",{staticClass:"u-producer",attrs:{src:t.getCdnImgUrl("producer.png")}}),e("img",{staticClass:"u-title__icon",attrs:{src:t.getCdnImgUrl("portrait/title_icon.png")}})]),e("div",{staticClass:"m-info"},[e("div",{staticClass:"u-producer__text"},[t._v("*剑网3魔盒提供技术支持，茗伊插件提供数据支持。")]),e("div",{staticClass:"m-user"},[e("span",{staticClass:"u-name"},[t._v(t._s(t.roleInfo.name))]),t.roleInfo.mount?e("img",{staticClass:"u-icon",attrs:{src:t.showSchoolIcon(t.roleInfo.mount)}}):t._e()]),e("div",{staticClass:"u-progress"},[t._v("奇遇进度："+t._s(t.userAchievement.progress)+"%")]),e("div",{staticClass:"u-time"},[t._v("记录时间："+t._s(t.userAchievement.updated_at))]),e("img",{staticClass:"m-tip",attrs:{src:t.getCdnImgUrl("poetry_por.png")}})]),e("img",{staticClass:"u-introduce__bg",attrs:{src:t.getCdnImgUrl("content_bg.png")}})]),t.userAchievement?[e("div",{staticClass:"m-world"},[e("img",{staticClass:"u-world__bg",attrs:{src:t.getCdnImgUrl("world/world_bg.svg")}}),e("div",{staticClass:"m-world-count"},[e("img",{staticClass:"u-count__img",attrs:{src:t.getCdnImgUrl("portrait/world_qy_bg.png")}}),e("div",{staticClass:"m-count-info"},[t._v(" "+t._s(t.userAchievement.perfectNowNum+"/"+t.userAchievement.perfectAllNum)+" ")])]),t._l(t.userAchievement.perfect,(function(a,s){return[e("img",{key:"img-".concat(a.dwID,"-").concat(s),staticClass:"u-item__img",class:a.hasClass,style:{zIndex:a.zIndex},attrs:{src:t.getCdnImgUrl("world/".concat(a.dwID).concat(a.isAct?"_act":"",".png"))}}),e("div",{key:"text-".concat(a.dwID,"-").concat(s),staticClass:"m-item__text",class:a.hasClass},[e("img",{staticClass:"u-item__bg",attrs:{src:t.getCdnImgUrl("world/text_bg".concat(a.isAct?"_act":"",".png"))}}),e("span",{staticClass:"u-item__text"},[t._v(t._s(a.szName))])])]}))],2),e("div",{staticClass:"m-qy-box"},[e("div",{staticClass:"m-qy m-ordinary"},[e("div",{staticClass:"m-qy-count"},[e("img",{staticClass:"u-count__img",attrs:{src:t.getCdnImgUrl("portrait/pt_qy_bg.png")}}),e("div",{staticClass:"m-count-info"},[t._v(" "+t._s(t.userAchievement.normalNowNum+"/"+t.userAchievement.normalAllNum)+" ")])]),t.userAchievement.normal.length?e("div",{staticClass:"m-qy-list"},t._l(t.userAchievement.normal,(function(a,s){return e("div",{key:s,staticClass:"m-qy__item"},[[4,118].indexOf(a.dwID)>-1?[e("img",{directives:[{name:"show",rawName:"v-show",value:"hq"==t.currentCamp,expression:"currentCamp == 'hq'"}],staticClass:"u-qy__img",attrs:{src:t.getCdnImgUrl("pt/".concat(a.dwID,"_hq.png"))}}),e("img",{directives:[{name:"show",rawName:"v-show",value:"er"==t.currentCamp,expression:"currentCamp == 'er'"}],staticClass:"u-qy__img",attrs:{src:t.getCdnImgUrl("pt/".concat(a.dwID,"_er.png"))}}),e("img",{directives:[{name:"show",rawName:"v-show",value:!t.currentCamp,expression:"!currentCamp"}],staticClass:"u-qy__img",attrs:{src:t.getCdnImgUrl("pt/".concat(a.dwID,".png"))}})]:e("el-image",{staticClass:"u-qy__img",attrs:{src:t.getCdnImgUrl("pt/".concat(a.dwID,".png"))}},[e("el-image",{staticClass:"u-qy__img",attrs:{slot:"error",src:t.getCdnImgUrl("pt/default.png")},slot:"error"})],1),e("div",{staticClass:"m-qy__text"},[e("img",{staticClass:"u-qy__bg",attrs:{src:t.getCdnImgUrl("pt/text_bg.png")}}),e("span",{staticClass:"u-qy__text"},[t._v(t._s(a.szName))])])],2)})),0):e("div",{staticClass:"u-no-qy"},[e("img",{attrs:{src:t.getCdnImgUrl("portrait/no_qy.png")}})])]),e("div",{staticClass:"m-qy m-pet"},[e("div",{staticClass:"m-qy-count"},[e("img",{staticClass:"u-count__img",attrs:{src:t.getCdnImgUrl("portrait/pet_qy_bg.png")}}),e("div",{staticClass:"m-count-info"},[t._v(" "+t._s(t.userAchievement.petNowNum+"/"+t.userAchievement.petAllNum)+" ")])]),t.userAchievement.pet.length?e("div",{staticClass:"m-qy-list"},t._l(t.userAchievement.pet,(function(a,s){return e("div",{key:s,staticClass:"m-qy__item"},[e("img",{staticClass:"u-qy__img",attrs:{src:t.getImgUrl(a)}}),e("img",{staticClass:"u-qy__border",attrs:{src:t.getCdnImgUrl("pet_img_border.png")}})])})),0):e("div",{staticClass:"u-no-qy"},[e("img",{attrs:{src:t.getCdnImgUrl("portrait/no_qy.png")}})])])])]:t._e(),e("div",{staticClass:"m-bottom",class:{start:t.addClass,over:t.isOver}},[e("img",{staticClass:"u-bottom__img",attrs:{src:t.getCdnImgUrl("portrait/bottom.png")}})])],2):t._e()},n=[],r=(a("a9e3"),a("ac1f"),a("5319"),a("85e4")),i=a("01ea"),o={name:"landscapeContent",props:{userAchievement:{type:[Object,Boolean],default:function(){}},roleInfo:{type:Object,default:function(){}},__imgRoot:{type:String,required:!0},addClass:{type:Boolean,default:!1},isOver:{type:Boolean,default:!1},contentZoom:{type:[Number,String],default:""},currentCamp:{type:String,default:"hq"}},data:function(){return{}},methods:{showSchoolIcon:r["t"],getCdnImgUrl:function(t){return"".concat(i["__cdn"],"design/treasure/").concat(t)},getImgUrl:function(t){var e,a="std",s=null===(e=t.szOpenRewardPath)||void 0===e?void 0:e.toLowerCase();if(!s)return"";if(s=s.replace(/\\/g,"/").replace("ui/image/adventure/",""),!t.szRewardType){var n=s.replace(/\.tga$/,".png");return"".concat(this.__imgRoot,"adventure/").concat(a,"/").concat(n)}return s=s.replace(/\/[^\/]+?\.tga$/,""),"camp"===t.szRewardType?"".concat(this.__imgRoot,"adventure/").concat(a,"/").concat(s,"/camp_").concat(this.camp,"_open.png"):"school"===t.szRewardType?"".concat(this.__imgRoot,"adventure/").concat(a,"/").concat(s,"/school_").concat(this.force,"_open.png"):defaultImg}}},c=o,l=(a("1a39"),a("2877")),u=Object(l["a"])(c,s,n,!1,null,null,null);e["a"]=u.exports},fe9e:function(t,e,a){"use strict";a.r(e);a("b0c0");var s=function(){var t=this,e=t._self._c;return e("div",{staticClass:"m-body"},[t.isLogin?t.noRole?[e("div",{staticClass:"u-bind_role"},[e("el-empty",{attrs:{description:"当前暂未绑定角色",image:t.__imgPath+"/img/common/empty.png","image-size":200}},[e("a",{staticClass:"u-btn el-button el-button--primary",attrs:{href:"/team/role/bind"}},[t._v("前往绑定 "),e("i",{staticClass:"el-icon-arrow-right"})])])],1)]:[e("div",{staticClass:"m-related-roles"},[e("el-select",{attrs:{"value-key":"ID",placeholder:"请选择当前角色",disabled:!t.isLogin,"popper-class":"m-related-roles-options",size:"small"},model:{value:t.currentRole,callback:function(e){t.currentRole=e},expression:"currentRole"}},[e("span",{staticClass:"u-prefix",attrs:{slot:"prefix"},slot:"prefix"},[t._v(" 角色名称 "),t.isVirtual||t.isSync?t._e():e("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:"请先在游戏中同步成就",placement:"top"}},[e("a",{attrs:{href:"/tool/74559",target:"_blank"}},[e("i",{staticClass:"el-icon-warning-outline"})])])],1),t._l(t.roleList,(function(a){return e("el-option",{key:a.ID,attrs:{value:a,label:a.name}},[e("span",{staticClass:"u-role"},[e("span",{staticClass:"u-role-name"},[e("img",{staticClass:"u-role-icon",attrs:{src:t.showSchoolIcon(a.mount)}}),t._v(t._s(a.name))]),e("span",{staticClass:"u-role-server"},[t._v(t._s(a.server))])])])}))],2),e("el-select",{attrs:{placeholder:"请选择阵营","popper-class":"m-related-roles-options",size:"small"},model:{value:t.currentCamp,callback:function(e){t.currentCamp=e},expression:"currentCamp"}},[e("span",{staticClass:"u-prefix",attrs:{slot:"prefix"},slot:"prefix"},[t._v("所在阵营")]),e("el-option",{attrs:{value:"hq",label:"浩气盟阵营"}}),e("el-option",{attrs:{value:"er",label:"恶人谷阵营"}})],1),e("div",{staticClass:"u-action"},[e("el-tooltip",{attrs:{content:"刷新QQ机器人等渠道快照图片"}},[e("el-button",{staticClass:"u-refresh",attrs:{size:"small"},on:{click:t.onRefresh}},[e("i",{staticClass:"el-icon-refresh"}),t._v("刷新卷轴")])],1),e("el-button",{staticClass:"u-role-setting",attrs:{size:"small"},on:{click:t.onRoleSet}},[e("i",{staticClass:"el-icon-setting"}),t._v("角色管理")])],1)],1),t.noRole?t._e():e("div",{ref:"capture",attrs:{id:"capture"}},[e("portraitContent",{attrs:{"__img-root":t.__imgRoot,"user-achievement":t.userAchievement,"role-info":t.roleInfo,"add-class":t.addClass,"is-over":t.isOver,"content-zoom":t.contentZoom,"current-camp":t.currentCamp}})],1)]:[e("div",{staticClass:"u-bind_role"},[e("el-empty",{attrs:{description:"您还没有登录",image:t.__imgPath+"/img/common/empty.png","image-size":200}},[e("div",{staticClass:"u-btn el-button el-button--primary",on:{click:t.goLogin}},[t._v(" 前往登录 "),e("i",{staticClass:"el-icon-arrow-right"})])])],1)]],2)},n=[],r=a("c14f"),i=a("1da1"),o=a("b85c"),c=a("5530"),l=(a("99af"),a("4de4"),a("7db0"),a("e9f5"),a("910d"),a("f665"),a("d3b7"),a("ac1f"),a("00b4"),a("5319"),a("987d")),u=a("85e4"),m=a("42e9"),d=a("c9d2"),g=a("c0e9"),p=a.n(g),_=a("01ea"),v=a("e5d0"),f=a("7720"),h={name:"portrait",inject:["__imgRoot","__imgPath"],components:{portraitContent:v["a"]},data:function(){return{addClass:!1,isOver:!1,contentZoom:"",userAchievement:!1,roleList:[],noRole:!1,currentRole:"",currentCamp:"",roleInfo:{},isLogin:d["a"].isLogin(),virtualRole:Object(c["a"])(Object(c["a"])({},d["a"].getInfo()),{},{jx3id:0,ID:~~d["a"].getInfo().uid}),isSync:!1,isMiniProgram:Object(u["m"])()}},computed:{client:function(){return this.$store.state.client}},watch:{currentRole:{deep:!0,handler:function(t){this.roleInfo=t,t.jx3id&&this.loadRole(t.jx3id)}},virtualRole:{immediate:!0,deep:!0,handler:function(t){this.currentRole=t}}},created:function(){if(this.isMiniProgram&&/iPhone|iPad|iPod/i.test(navigator.userAgent)){var t,e=document.getElementsByClassName("v-miniprogram"),a=Object(o["a"])(e);try{for(a.s();!(t=a.n()).done;){var s=t.value;s.style.removeProperty("font-size"),s.style.fontSize="16px"}}catch(n){a.e(n)}finally{a.f()}}},mounted:function(){var t=this;Object(l["e"])().then((function(e){var a,s;e.data.data.list.length?(t.noRole=!1,t.roleList=(null===(a=e.data)||void 0===a||null===(s=a.data)||void 0===s?void 0:s.list.filter((function(t){return!!t.player_id})))||[],t.roleList.length&&(t.currentRole=t.roleList.find((function(t){return t.is_default_role}))||t.roleList[0])):(t.noRole=!0,t.$message.error("未获取到角色信息"))}))},methods:{goLogin:function(){Object(f["a"])()},onRoleSet:function(){window.open("".concat(_["__Root"],"dashboard/role"),"_blank")},onRefresh:function(){var t=this;Object(l["f"])({mode:"portrait",role:this.currentRole.name,server:this.currentRole.server}).then((function(){t.$message.success("刷新卷轴成功")}))},saveAsImage:function(){var t=this;return Object(i["a"])(Object(r["a"])().m((function e(){var a,s,n,i,o,c;return Object(r["a"])().w((function(e){while(1)switch(e.p=e.n){case 0:return e.p=0,a=t.contentZoom,t.contentZoom=1,e.n=1,new Promise((function(e){t.$nextTick((function(){e()}))}));case 1:return s=t.$refs.capture,e.n=2,p()(s,{allowTaint:!0,useCORS:!0,width:s.offsetWidth,height:s.offsetHeight});case 2:n=e.v,t.contentZoom=a,i=n.toDataURL("image/png"),o=document.createElement("a"),o.href=i,o.download="downloaded-image.png",o.click(),e.n=4;break;case 3:e.p=3,c=e.v,console.error("Error saving image:",c);case 4:return e.a(2)}}),e,null,[[0,3]])})))()},loadRole:function(t){var e=this;Object(m["a"])(t).then((function(a){e.isSync=!!t,e.userAchievement=a,e.addClass=!1,e.isOver=!1,e.$nextTick((function(t){e.start()}))}))},start:function(){var t=this;this.addClass=!0,setTimeout((function(){t.addClass=!1,t.isOver=!0}),2e3),window.addEventListener("resize",this.handleScreenWidthChange),window.addEventListener("load",this.handleScreenWidthChange),this.handleScreenWidthChange()},isVirtual:function(){var t;return!(null!==(t=this.currentRole)&&void 0!==t&&t.jx3id)},getImgUrl:function(t){var e,a="std",s=null===(e=t.szOpenRewardPath)||void 0===e?void 0:e.toLowerCase();if(!s)return"";if(s=s.replace(/\\/g,"/").replace("ui/image/adventure/",""),!t.szRewardType){var n=s.replace(/\.tga$/,".png");return"".concat(this.__imgRoot,"adventure/").concat(a,"/").concat(n)}return s=s.replace(/\/[^\/]+?\.tga$/,""),"camp"===t.szRewardType?"".concat(this.__imgRoot,"adventure/").concat(a,"/").concat(s,"/camp_").concat(this.camp,"_open.png"):"school"===t.szRewardType?"".concat(this.__imgRoot,"adventure/").concat(a,"/").concat(s,"/school_").concat(this.force,"_open.png"):defaultImg},handleScreenWidthChange:function(){var t=window.innerWidth-40,e=900,a=t/e,s=1;t<=e&&(s=a),this.contentZoom=s},showSchoolIcon:u["t"],getCdnImgUrl:function(t){return"".concat(_["__cdn"],"design/treasure/").concat(t)}}},C=h,b=(a("91f1"),a("2877")),y=Object(b["a"])(C,s,n,!1,null,null,null);e["default"]=y.exports}}]);